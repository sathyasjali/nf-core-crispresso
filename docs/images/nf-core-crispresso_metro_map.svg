<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      /* Metro lines - following nf-core style guide */
      .metro-line { fill: none; stroke-width: 12; stroke-linecap: round; stroke-linejoin: round; }
      .main-line { stroke: #1f77b4; } /* Blue - main workflow */
      .qc-line { stroke: #2ca02c; } /* Green - quality control */
      .analysis-line { stroke: #ff7f0e; } /* Orange - analysis */
      .report-line { stroke: #9467bd; } /* Purple - reporting */
      
      /* Stations - nf-core tube map style */
      .station { fill: white; stroke-width: 4; }
      .station-main { stroke: #1f77b4; }
      .station-qc { stroke: #2ca02c; }
      .station-analysis { stroke: #ff7f0e; }
      .station-report { stroke: #9467bd; }
      .station-terminal { stroke: #333333; stroke-width: 6; }
      
      /* Typography - matching nf-core standards */
      .station-text { 
        font-family: 'Arial', 'Helvetica', sans-serif; 
        font-size: 12px; 
        font-weight: bold; 
        text-anchor: middle; 
        fill: #333333; 
      }
      .station-label { 
        font-family: 'Arial', 'Helvetica', sans-serif; 
        font-size: 9px; 
        text-anchor: middle; 
        fill: #666666; 
      }
      .title { 
        font-family: 'Arial', 'Helvetica', sans-serif; 
        font-size: 28px; 
        font-weight: bold; 
        text-anchor: middle; 
        fill: #333333; 
      }
      .subtitle { 
        font-family: 'Arial', 'Helvetica', sans-serif; 
        font-size: 16px; 
        text-anchor: middle; 
        fill: #666666; 
      }
      .legend-text { 
        font-family: 'Arial', 'Helvetica', sans-serif; 
        font-size: 11px; 
        fill: #333333; 
      }
      .legend-title { 
        font-family: 'Arial', 'Helvetica', sans-serif; 
        font-size: 14px; 
        font-weight: bold; 
        fill: #333333; 
      }
    </style>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="800" fill="white"/>
  
  <!-- Title - nf-core style -->
  <text x="600" y="40" class="title">nf-core/crispresso</text>
  <text x="600" y="65" class="subtitle">CRISPR editing analysis pipeline</text>
  
  <!-- Main workflow line (horizontal backbone) -->
  <path d="M 100 250 L 1100 250" class="metro-line main-line"/>
  
  <!-- QC branch - curves following tube map style -->
  <path d="M 250 250 Q 250 200 300 200 L 600 200 Q 650 200 650 250" class="metro-line qc-line"/>
  
  <!-- Analysis detail branch -->
  <path d="M 500 250 Q 500 350 550 350 L 650 350 Q 700 350 700 250" class="metro-line analysis-line"/>
  
  <!-- Report processing branch -->
  <path d="M 700 250 Q 700 450 750 450 L 850 450 Q 900 450 900 250" class="metro-line report-line"/>
  
  <!-- INPUT Terminal -->
  <circle cx="100" cy="250" r="25" class="station station-terminal"/>
  <text x="100" y="230" class="station-text">INPUT</text>
  <text x="100" y="280" class="station-label">samplesheet.csv</text>
  <text x="100" y="295" class="station-label">FASTQ files</text>
  
  <!-- FastQC Station -->
  <circle cx="250" cy="250" r="20" class="station station-qc"/>
  <text x="250" y="225" class="station-text">FastQC</text>
  <text x="250" y="280" class="station-label">read quality control</text>
  
  <!-- QC Processing -->
  <circle cx="450" cy="200" r="16" class="station station-qc"/>
  <text x="450" y="185" class="station-text">QC</text>
  <text x="450" y="175" class="station-label">processing</text>
  
  <!-- CRISPResso2 Main Hub -->
  <circle cx="500" cy="250" r="30" class="station station-analysis"/>
  <text x="500" y="220" class="station-text">CRISPResso2</text>
  <text x="500" y="235" class="station-text">Analysis</text>
  <text x="500" y="285" class="station-label">editing quantification</text>
  <text x="500" y="300" class="station-label">mutation detection</text>
  
  <!-- Detailed Analysis Hub -->
  <circle cx="600" cy="350" r="18" class="station station-analysis"/>
  <text x="600" y="335" class="station-text">Detailed</text>
  <text x="600" y="348" class="station-text">Analysis</text>
  <text x="600" y="375" class="station-label">amplicon alignment</text>
  <text x="600" y="390" class="station-label">indel quantification</text>
  
  <!-- Results Summary -->
  <circle cx="700" cy="250" r="20" class="station station-report"/>
  <text x="700" y="225" class="station-text">Results</text>
  <text x="700" y="238" class="station-text">Summary</text>
  <text x="700" y="280" class="station-label">CSV generation</text>
  
  <!-- Report Processing -->
  <circle cx="800" cy="450" r="16" class="station station-report"/>
  <text x="800" y="435" class="station-text">Report</text>
  <text x="800" y="448" class="station-text">Processing</text>
  <text x="800" y="475" class="station-label">data aggregation</text>
  
  <!-- MultiQC Hub -->
  <circle cx="900" cy="250" r="25" class="station station-report"/>
  <text x="900" y="225" class="station-text">MultiQC</text>
  <text x="900" y="285" class="station-label">interactive dashboard</text>
  
  <!-- OUTPUT Terminal -->
  <circle cx="1100" cy="250" r="25" class="station station-terminal"/>
  <text x="1100" y="230" class="station-text">OUTPUT</text>
  <text x="1100" y="280" class="station-label">results/</text>
  
  <!-- Input type indicators - tube map style badges -->
  <rect x="120" y="220" width="60" height="16" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="8"/>
  <text x="150" y="230" style="font-size: 9px; text-anchor: middle; fill: #1565c0; font-weight: bold;">single-end</text>
  
  <rect x="120" y="270" width="60" height="16" fill="#e8f5e8" stroke="#388e3c" stroke-width="2" rx="8"/>
  <text x="150" y="280" style="font-size: 9px; text-anchor: middle; fill: #2e7d32; font-weight: bold;">paired-end</text>
  
  <!-- Analysis mode badges -->
  <rect x="440" y="320" width="70" height="16" fill="#fff3e0" stroke="#f57c00" stroke-width="2" rx="8"/>
  <text x="475" y="330" style="font-size: 9px; text-anchor: middle; fill: #e65100; font-weight: bold;">base editor</text>
  
  <rect x="530" y="320" width="40" height="16" fill="#ffebee" stroke="#d32f2f" stroke-width="2" rx="8"/>
  <text x="550" y="330" style="font-size: 9px; text-anchor: middle; fill: #c62828; font-weight: bold;">NHEJ</text>
  
  <!-- Connection indicators - small circles at junctions -->
  <circle cx="250" cy="250" r="4" fill="#1f77b4"/>
  <circle cx="500" cy="250" r="4" fill="#1f77b4"/>
  <circle cx="650" cy="250" r="4" fill="#2ca02c"/>
  <circle cx="700" cy="250" r="4" fill="#1f77b4"/>
  <circle cx="900" cy="250" r="4" fill="#1f77b4"/>
  
  <!-- Legend - comprehensive nf-core style -->
  <g transform="translate(50, 550)">
    <rect x="0" y="0" width="1100" height="200" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" rx="10"/>
    <text x="550" y="25" class="legend-title" text-anchor="middle">nf-core/crispresso Metro Map Legend</text>
    
    <!-- Line legend -->
    <text x="30" y="50" class="legend-title">Workflow Lines:</text>
    
    <line x1="30" y1="70" x2="80" y2="70" stroke="#1f77b4" stroke-width="8" stroke-linecap="round"/>
    <text x="90" y="75" class="legend-text">Main workflow</text>
    
    <line x1="200" y1="70" x2="250" y2="70" stroke="#2ca02c" stroke-width="8" stroke-linecap="round"/>
    <text x="260" y="75" class="legend-text">Quality control</text>
    
    <line x1="370" y1="70" x2="420" y2="70" stroke="#ff7f0e" stroke-width="8" stroke-linecap="round"/>
    <text x="430" y="75" class="legend-text">CRISPR analysis</text>
    
    <line x1="550" y1="70" x2="600" y2="70" stroke="#9467bd" stroke-width="8" stroke-linecap="round"/>
    <text x="610" y="75" class="legend-text">Report generation</text>
    
    <!-- Station legend -->
    <text x="30" y="110" class="legend-title">Station Types:</text>
    
    <circle cx="55" cy="130" r="15" class="station station-terminal"/>
    <text x="80" y="135" class="legend-text">Input/Output terminals</text>
    
    <circle cx="230" cy="130" r="12" class="station station-qc"/>
    <text x="250" y="135" class="legend-text">Quality control</text>
    
    <circle cx="380" cy="130" r="18" class="station station-analysis"/>
    <text x="405" y="135" class="legend-text">Analysis processes</text>
    
    <circle cx="550" cy="130" r="15" class="station station-report"/>
    <text x="575" y="135" class="legend-text">Reporting</text>
    
    <!-- Features -->
    <text x="700" y="110" class="legend-title">Pipeline Features:</text>
    <text x="700" y="130" class="legend-text">• Single-end and paired-end FASTQ support</text>
    <text x="700" y="145" class="legend-text">• Comprehensive CRISPR editing analysis</text>
    <text x="700" y="160" class="legend-text">• Base editor and NHEJ analysis modes</text>
    <text x="700" y="175" class="legend-text">• Integrated quality control and reporting</text>
  </g>
  
  <!-- nf-core branding -->
  <text x="1150" y="780" style="font-size: 10px; text-anchor: end; fill: #999;">nf-core/crispresso</text>
  <text x="50" y="780" style="font-size: 10px; fill: #999;">Following nf-core metro map design guidelines</text>
</svg>
</svg>
